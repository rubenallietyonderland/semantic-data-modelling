unique_name: MAPPING_ONE_TABLE_SERVICES
object_type: dataset
label: MAPPING_ONE_TABLE_SERVICE
columns:
  - name: ORDER_ID
    data_type: decimal(38,0)
  - name: ITEM_ID
    data_type: decimal(38,0)
  - name: SERVICE_ITEM_PK
    data_type: string
  - name: SERVICE_ITEM_ID
    data_type: decimal(38,0)
  - name: SERVICE_ID
    data_type: decimal(38,0)
  - name: PRICING
    data_type: double
  - name: PROMISED_LEAD_TIME
    data_type: double
  - name: FLAG_MULTIPLESERVICES
    data_type: string
  - name: NUMBER_OF_LOCATIONS
    data_type: decimal(18,0)
  - name: MULTIPLESERVICE_DESCRIPTION
    data_type: string
  - name: SERVICE_STATUS_NAME
    data_type: string
  - name: SERVICE_CREATED_BY_EMPLOYEE_FK
    data_type: string
  - name: SERVICE_ARRIVED_WAREHOUSE_UPDATED_BY_EMPLOYEE_FK
    data_type: string
  - name: ORDER_STATUS_NAME
    data_type: string
  - name: ITEM_STATUS_NAME
    data_type: string
  - name: ORDER_PK
    data_type: string
  - name: ITEM_PK
    data_type: string
  - name: LT_PRODUCT_CAT
    data_type: string
connection_id: con_MART_SERVICES
sql: >-
  SELECT 

  ORDER_PK, ORDER_ID, ORDER_STATUS_NAME,

  ITEM_PK, ITEM_ID, ITEM_STATUS_NAME,

  SERVICE_ITEM_PK, SERVICE_ITEM_ID, SERVICE_ID, PRICING, PROMISED_LEAD_TIME,
  FLAG_MULTIPLESERVICES, NUMBER_OF_LOCATIONS, MULTIPLESERVICE_DESCRIPTION,
  SERVICE_STATUS_NAME, SERVICE_CREATED_BY_EMPLOYEE_FK,
  SERVICE_ARRIVED_WAREHOUSE_UPDATED_BY_EMPLOYEE_FK, 

  CASE WHEN ITEM_LEAD_TIME_STATUS_2_15   < 14 THEN '< 2 weeks'
       WHEN ITEM_LEAD_TIME_STATUS_2_15   > 14 AND  ITEM_LEAD_TIME_STATUS_2_15  < 21 THEN '> 2 weeks'
        WHEN ITEM_LEAD_TIME_STATUS_2_15   > 21 AND ITEM_LEAD_TIME_STATUS_2_15   < 28 THEN  '> 3 weeks'
          WHEN ITEM_LEAD_TIME_STATUS_2_15   > 28 THEN '> 4 weeks' ELSE '' END as LT_product_Cat
  FROM

  ACC_LH_438.MART_SERVICES.FCT_ATSCALE_SERVICES
